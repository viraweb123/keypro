'use strict';function _asyncToGenerator(fn){return function(){var gen=fn.apply(this,arguments);return new Promise(function(resolve,reject){function step(key,arg){try{var info=gen[key](arg);var value=info.value;}catch(error){reject(error);return;}if(info.done){resolve(value);}else{return Promise.resolve(value).then(function(value){return step("next",value);},function(err){return step("throw",err);});}}return step("next");});};}var desktopStateController=function desktopStateController($scope,$rootScope,desktopService,toaster,$state,$translate,$sce,$window,$timeout,Authentication,$uibModal,$compile,userInfoService){return new Promise(function(resolve,reject){var _this=this;try{$scope.data={directive:{propertyGroupWizard:null},isSpecialDocOrFolder:false,signValidesTypes:['.odt'],printPreviewWindow:null,clipboardFolder:null,showClipboardFolder:false,clipboardFolderPushed:false,PropertyGroupParent:null,selectMetadataParent:null,metadataParent:null,formMetadataParent:null,isShowItem:true,selectAll:false,docVersions:[],Properties:null,showFormGeneratorButtons:true,metadatas:null,selectMetadata:null,metadata:null,selectPropertyGroup:-1,PropertyGroup:null,removeExternalFuncs:{},removeExternalCSS:{},state:'desktop',profile:null,selectedFileOrFolder:null,nodesFolder:{},trees:{//TODO  Taxonomy Tree
taxonomyVisible:null,taxonomyTree:{},taxonomy:{index:1,list:{copyFile:{title:$translate.instant('angularTreeView.addPage'),rootAccess:false,readOnly:true,icon:'fa fa-file',func:function func(currentNode){return $scope.func.runSelectTreeFunction('copyFile',currentNode,"taxonomyVisible","taxonomy");}},createFolder:{title:$translate.instant('angularTreeView.createNewFolder'),rootAccess:false,readOnly:true,icon:'fa fa-folder fa-flip-horizontal',func:function func(currentNode){return $scope.func.runSelectTreeFunction('createFolder',currentNode,"taxonomyVisible","taxonomy");}},copyFolder:{title:$translate.instant('angularTreeView.copy'),rootAccess:true,readOnly:true,icon:'fa fa-copy',func:function func(currentNode){return $scope.func.runSelectTreeFunction('copyFolder',currentNode,"taxonomyVisible","taxonomy");}},cutFolder:{title:$translate.instant('angularTreeView.transfer'),icon:'fa fa-scissors',rootAccess:true,readOnly:true,func:function func(currentNode){return $scope.func.runSelectTreeFunction('cutFolder',currentNode,"taxonomyVisible","taxonomy",'getRootFolder');}},deleteFolder:{title:$translate.instant('angularTreeView.delete'),rootAccess:true,readOnly:true,icon:'fa fa-trash',func:function func(currentNode){return $scope.func.runSelectTreeFunction('deleteFolder',currentNode,"taxonomyVisible","taxonomy");}},renameFolder:{title:$translate.instant('angularTreeView.rename'),rootAccess:true,readOnly:true,icon:'fa fa-i-cursor',func:function func(currentNode){return $scope.func.runSelectTreeFunction('renameFolder',currentNode,"taxonomyVisible","taxonomy");}},exportZip:{title:$translate.instant('angularTreeview.exportZip'),rootAccess:false,readOnly:false,icon:'fa fa-file-archive-o',func:function func(currentNode){return $scope.func.runSelectTreeFunction('exportToZip',currentNode);}},addCategoty:{title:$translate.instant('angularTreeview.addCategory'),rootAccess:true,readOnly:true,icon:'fa fa-list',func:function func(currentNode){return $scope.func.runSelectTreeFunction('addCategoty',currentNode,"categoryVisible","category");}}},uuid:null,currentNodeCount:-1,changeCurrentNode:function(){var _ref=_asyncToGenerator(regeneratorRuntime.mark(function _callee(node,collapsed,viewDoc){return regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;$scope.func.changeCurrentNodeTaxonomy(node,collapsed,viewDoc);_context.next=22;break;case 4:_context.prev=4;_context.t0=_context['catch'](0);console.error(_context.t0);_context.prev=7;_context.next=10;return JSManagement.addJS('ecma5/ExternalLiberary/Desktop/insideController/functions/changeCurrentNodeTaxonomy.js?dev='+randomVersionName);case 10:$scope.data.removeExternalFuncs['ecma5/ExternalLiberary/Desktop/insideController/functions/changeCurrentNodeTaxonomy.js?dev='+randomVersionName]='changeCurrentNodeTaxonomyDesktopCtrl';_context.next=13;return changeCurrentNodeTaxonomyDesktopCtrl($scope,desktopService,JSManagement,CSSManagement,toaster,$uibModal);case 13:$scope.func.changeCurrentNodeTaxonomy(node,collapsed,viewDoc);_context.next=19;break;case 16:_context.prev=16;_context.t1=_context['catch'](7);console.error(_context.t1);case 19:_context.prev=19;_.defer(function(){return $scope.$apply();});return _context.finish(19);case 22:case'end':return _context.stop();}}},_callee,_this,[[0,4],[7,16,19,22]]);}));function changeCurrentNode(_x,_x2,_x3){return _ref.apply(this,arguments);}return changeCurrentNode;}()},//TODO  Metadata Tree
metadataVisible:null,metadataTree:{},metadata:{index:1,list:{},uuid:null,currentNodeCount:-1,changeCurrentNode:function(){var _ref2=_asyncToGenerator(regeneratorRuntime.mark(function _callee2(node,collapsed){return regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.prev=0;$scope.func.changeCurrentNodeMetaData(node,collapsed);_context2.next=22;break;case 4:_context2.prev=4;_context2.t0=_context2['catch'](0);console.error(_context2.t0);_context2.prev=7;_context2.next=10;return JSManagement.addJS('ecma5/ExternalLiberary/Desktop/insideController/functions/changeCurrentNodeMetaData.js?dev='+randomVersionName);case 10:$scope.data.removeExternalFuncs['ecma5/ExternalLiberary/Desktop/insideController/functions/changeCurrentNodeMetaData.js?dev='+randomVersionName]='changeCurrentNodeMetaDataDesktopCtrl';_context2.next=13;return changeCurrentNodeMetaDataDesktopCtrl($scope,desktopService,JSManagement,CSSManagement,toaster,$uibModal);case 13:$scope.func.changeCurrentNodeMetaData(node,collapsed);_context2.next=19;break;case 16:_context2.prev=16;_context2.t1=_context2['catch'](7);console.error(_context2.t1);case 19:_context2.prev=19;_.defer(function(){return $scope.$apply();});return _context2.finish(19);case 22:case'end':return _context2.stop();}}},_callee2,_this,[[0,4],[7,16,19,22]]);}));function changeCurrentNode(_x4,_x5){return _ref2.apply(this,arguments);}return changeCurrentNode;}()},//TODO  Category Tree
categoryVisible:null,categoryTree:{},category:{index:1,list:{cteateFolder:{title:$translate.instant('angularTreeView.createNewFolder'),rootAccess:false,readOnly:true,icon:'fa fa-folder fa-flip-horizontal',func:function func(currentNode){return $scope.func.runSelectTreeFunction('createFolder',currentNode,"categoryVisible","category");}},exportZip:{title:$translate.instant('angularTreeview.exportZip'),rootAccess:false,readOnly:false,icon:'fa fa-file-archive-o',func:function func(currentNode){return $scope.func.runSelectTreeFunction('exportToZip',currentNode);}},renameFolder:{title:$translate.instant('angularTreeView.rename'),rootAccess:true,readOnly:true,icon:'fa fa-i-cursor',func:function func(currentNode){return $scope.func.runSelectTreeFunction('renameFolder',currentNode,"categoryVisible","category");}},cutFolder:{title:$translate.instant('angularTreeView.transfer'),icon:'fa fa-scissors',rootAccess:true,readOnly:true,func:function func(currentNode){return $scope.func.runSelectTreeFunction('cutFolder',currentNode,"categoryVisible","category",'getCategoriesFolder');}},deleteFolder:{title:$translate.instant('angularTreeView.delete'),rootAccess:true,readOnly:true,icon:'fa fa-trash',func:function func(currentNode){return $scope.func.runSelectTreeFunction('deleteFolder',currentNode,"categoryVisible","category");}}},uuid:null,currentNodeCount:-1,changeCurrentNode:function(){var _ref3=_asyncToGenerator(regeneratorRuntime.mark(function _callee3(node,collapsed,viewDoc){return regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.prev=0;$scope.func.changeCurrentNodeCategory(node,collapsed,viewDoc);_context3.next=22;break;case 4:_context3.prev=4;_context3.t0=_context3['catch'](0);console.error(_context3.t0);_context3.prev=7;_context3.next=10;return JSManagement.addJS('ecma5/ExternalLiberary/Desktop/insideController/functions/changeCurrentNodeCategory.js?dev='+randomVersionName);case 10:$scope.data.removeExternalFuncs['ecma5/ExternalLiberary/Desktop/insideController/functions/changeCurrentNodeCategory.js?dev='+randomVersionName]='changeCurrentNodeCategoryDesktopCtrl';_context3.next=13;return changeCurrentNodeCategoryDesktopCtrl($scope,desktopService,JSManagement,CSSManagement,toaster,$uibModal);case 13:$scope.func.changeCurrentNodeCategory(node,collapsed,viewDoc);_context3.next=19;break;case 16:_context3.prev=16;_context3.t1=_context3['catch'](7);console.error(_context3.t1);case 19:_context3.prev=19;_.defer(function(){return $scope.$apply();});return _context3.finish(19);case 22:case'end':return _context3.stop();}}},_callee3,_this,[[0,4],[7,16,19,22]]);}));function changeCurrentNode(_x6,_x7,_x8){return _ref3.apply(this,arguments);}return changeCurrentNode;}()},//TODO  Trash Tree
trashVisible:null,trashTree:{},trash:{index:1,list:{},uuid:null,currentNodeCount:-1,changeCurrentNode:function(){var _ref4=_asyncToGenerator(regeneratorRuntime.mark(function _callee4(node,collapsed){return regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:_context4.prev=0;$scope.func.changeCurrentNodeTrash(node,collapsed);_context4.next=22;break;case 4:_context4.prev=4;_context4.t0=_context4['catch'](0);console.error(_context4.t0);_context4.prev=7;_context4.next=10;return JSManagement.addJS('ecma5/ExternalLiberary/Desktop/insideController/functions/changeCurrentNodeTrash.js?dev='+randomVersionName);case 10:$scope.data.removeExternalFuncs['ecma5/ExternalLiberary/Desktop/insideController/functions/changeCurrentNodeTrash.js?dev='+randomVersionName]='changeCurrentNodeTrashDesktopCtrl';_context4.next=13;return changeCurrentNodeTrashDesktopCtrl($scope,desktopService,JSManagement,CSSManagement,toaster,$uibModal);case 13:$scope.func.changeCurrentNodeTrash(node,collapsed);_context4.next=19;break;case 16:_context4.prev=16;_context4.t1=_context4['catch'](7);console.error(_context4.t1);case 19:_context4.prev=19;_.defer(function(){return $scope.$apply();});return _context4.finish(19);case 22:case'end':return _context4.stop();}}},_callee4,_this,[[0,4],[7,16,19,22]]);}));function changeCurrentNode(_x9,_x10){return _ref4.apply(this,arguments);}return changeCurrentNode;}()},//TODO  Templates Tree
templatesVisible:null,templatesTree:{},templates:{index:1,list:{copyFile:{title:$translate.instant('angularTreeView.addPage'),rootAccess:false,readOnly:true,icon:'fa fa-file',func:function func(currentNode){return $scope.func.runSelectTreeFunction('copyFile',currentNode,"templatesVisible","templates");}},createFolder:{title:$translate.instant('angularTreeView.createNewFolder'),rootAccess:false,readOnly:true,icon:'fa fa-folder fa-flip-horizontal',func:function func(currentNode){return $scope.func.runSelectTreeFunction('createFolder',currentNode,"templatesVisible","templates");}},copyFolder:{title:$translate.instant('angularTreeView.copy'),rootAccess:true,readOnly:true,icon:'fa fa-copy',func:function func(currentNode){return $scope.func.runSelectTreeFunction('copyFolderWithTreeRoot',currentNode,"templatesVisible","templates","getTemplatesFolder");}},cutFolder:{title:$translate.instant('angularTreeView.transfer'),icon:'fa fa-scissors',rootAccess:true,readOnly:true,func:function func(currentNode){return $scope.func.runSelectTreeFunction('cutFolder',currentNode,"templatesVisible","templates",'getTemplatesFolder');}},deleteFolder:{title:$translate.instant('angularTreeView.delete'),rootAccess:true,readOnly:true,icon:'fa fa-trash',func:function func(currentNode){return $scope.func.runSelectTreeFunction('deleteFolder',currentNode,"templatesVisible","templates");}},renameFolder:{title:$translate.instant('angularTreeView.rename'),rootAccess:true,readOnly:true,icon:'fa fa-i-cursor',func:function func(currentNode){return $scope.func.runSelectTreeFunction('renameFolder',currentNode,"templatesVisible","templates");}},exportZip:{title:$translate.instant('angularTreeview.exportZip'),rootAccess:false,readOnly:false,icon:'fa fa-file-archive-o',func:function func(currentNode){return $scope.func.runSelectTreeFunction('exportToZip',currentNode);}},addCategoty:{title:$translate.instant('angularTreeview.addCategory'),rootAccess:true,readOnly:true,icon:'fa fa-list',func:function func(currentNode){return $scope.func.runSelectTreeFunction('addCategoty',currentNode,"categoryVisible","category");}}},uuid:null,currentNodeCount:-1,changeCurrentNode:function(){var _ref5=_asyncToGenerator(regeneratorRuntime.mark(function _callee5(node,collapsed,viewDoc){return regeneratorRuntime.wrap(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:_context5.prev=0;$scope.func.changeCurrentNodeTemplates(node,collapsed,viewDoc);_context5.next=22;break;case 4:_context5.prev=4;_context5.t0=_context5['catch'](0);console.error(_context5.t0);_context5.prev=7;_context5.next=10;return JSManagement.addJS('ecma5/ExternalLiberary/Desktop/insideController/functions/changeCurrentNodeTemplates.js?dev='+randomVersionName);case 10:$scope.data.removeExternalFuncs['ecma5/ExternalLiberary/Desktop/insideController/functions/changeCurrentNodeTemplates.js?dev='+randomVersionName]='changeCurrentNodeTemplatesDesktopCtrl';_context5.next=13;return changeCurrentNodeTemplatesDesktopCtrl($scope,desktopService,JSManagement,CSSManagement,toaster,$uibModal);case 13:$scope.func.changeCurrentNodeTemplates(node,collapsed,viewDoc);_context5.next=19;break;case 16:_context5.prev=16;_context5.t1=_context5['catch'](7);console.error(_context5.t1);case 19:_context5.prev=19;_.defer(function(){return $scope.$apply();});return _context5.finish(19);case 22:case'end':return _context5.stop();}}},_callee5,_this,[[0,4],[7,16,19,22]]);}));function changeCurrentNode(_x11,_x12,_x13){return _ref5.apply(this,arguments);}return changeCurrentNode;}()},//TODO  Personal Tree
personalVisible:null,personalTree:{},personal:{index:1,list:{copyFile:{title:$translate.instant('angularTreeView.addPage'),rootAccess:false,readOnly:true,icon:'fa fa-file',func:function func(currentNode){return $scope.func.runSelectTreeFunction('copyFile',currentNode,"personalVisible","personal");}},createFolder:{title:$translate.instant('angularTreeView.createNewFolder'),rootAccess:false,readOnly:true,icon:'fa fa-folder fa-flip-horizontal',func:function func(currentNode){return $scope.func.runSelectTreeFunction('createFolder',currentNode,"personalVisible","personal");}},copyFolder:{title:$translate.instant('angularTreeView.copy'),rootAccess:true,readOnly:true,icon:'fa fa-copy',func:function func(currentNode){return $scope.func.runSelectTreeFunction('copyFolderWithTreeRoot',currentNode,"personalVisible","personal","getUserPersonalFolder");}},cutFolder:{title:$translate.instant('angularTreeView.transfer'),icon:'fa fa-scissors',rootAccess:true,readOnly:true,func:function func(currentNode){return $scope.func.runSelectTreeFunction('cutFolder',currentNode,"personalVisible","personal",'getUserPersonalFolder');}},deleteFolder:{title:$translate.instant('angularTreeView.delete'),rootAccess:true,readOnly:true,icon:'fa fa-trash',func:function func(currentNode){return $scope.func.runSelectTreeFunction('deleteFolder',currentNode,"personalVisible","personal");}},renameFolder:{title:$translate.instant('angularTreeView.rename'),rootAccess:true,readOnly:true,icon:'fa fa-i-cursor',func:function func(currentNode){return $scope.func.runSelectTreeFunction('renameFolder',currentNode,"personalVisible","personal");}},exportZip:{title:$translate.instant('angularTreeview.exportZip'),rootAccess:false,readOnly:false,icon:'fa fa-file-archive-o',func:function func(currentNode){return $scope.func.runSelectTreeFunction('exportToZip',currentNode);}},addCategoty:{title:$translate.instant('angularTreeview.addCategory'),rootAccess:true,readOnly:true,icon:'fa fa-list',func:function func(currentNode){return $scope.func.runSelectTreeFunction('addCategoty',currentNode,"categoryVisible","category");}}},uuid:null,currentNodeCount:-1,changeCurrentNode:function(){var _ref6=_asyncToGenerator(regeneratorRuntime.mark(function _callee6(node,collapsed,viewDoc){return regeneratorRuntime.wrap(function _callee6$(_context6){while(1){switch(_context6.prev=_context6.next){case 0:_context6.prev=0;$scope.func.changeCurrentNodePersonal(node,collapsed,viewDoc);_context6.next=22;break;case 4:_context6.prev=4;_context6.t0=_context6['catch'](0);console.error(_context6.t0);_context6.prev=7;_context6.next=10;return JSManagement.addJS('ecma5/ExternalLiberary/Desktop/insideController/functions/changeCurrentNodePersonal.js?dev='+randomVersionName);case 10:$scope.data.removeExternalFuncs['ecma5/ExternalLiberary/Desktop/insideController/functions/changeCurrentNodePersonal.js?dev='+randomVersionName]='changeCurrentNodePersonalDesktopCtrl';_context6.next=13;return changeCurrentNodePersonalDesktopCtrl($scope,desktopService,JSManagement,CSSManagement,toaster,$uibModal);case 13:$scope.func.changeCurrentNodePersonal(node,collapsed,viewDoc);_context6.next=19;break;case 16:_context6.prev=16;_context6.t1=_context6['catch'](7);console.error(_context6.t1);case 19:_context6.prev=19;_.defer(function(){return $scope.$apply();});return _context6.finish(19);case 22:case'end':return _context6.stop();}}},_callee6,_this,[[0,4],[7,16,19,22]]);}));function changeCurrentNode(_x14,_x15,_x16){return _ref6.apply(this,arguments);}return changeCurrentNode;}()}},pointers:{"taxonomyVisible":{},"categoryVisible":{},"metadataVisible":{},"trashVisible":{},"templatesVisible":{},"personalVisible":{}},nav:{right:{selectedSide:null,isOpened:false,select:function select(selectedSide){if($scope.data.nav.right.selectedSide!=null&&$scope.data.nav.right.selectedSide!=selectedSide){try{window.document.querySelector('.D div.'+$scope.data.nav.right.selectedSide).classList.remove("show");}catch(e){console.error(e);}}try{window.document.querySelector('.D div.'+selectedSide).classList.add("show");}catch(e){console.error(e);}finally{$scope.data.nav.right.selectedSide=selectedSide;$scope.data.nav.right.isOpened=$scope.data.nav.right.isOpened||true;$scope.func.configStateIcons();$scope.func.zone[selectedSide]();}}},left:{selectedSide:null,isOpened:false,select:function select(selectedSide){if($scope.data.nav.left.selectedSide!=null&&$scope.data.nav.left.selectedSide!=selectedSide){try{window.document.querySelector('.D div.'+$scope.data.nav.left.selectedSide).classList.remove("show");}catch(e){console.error(e);}}try{window.document.querySelector('.D div.'+selectedSide).classList.add("show");}catch(e){console.error(e);}finally{$scope.data.nav.left.selectedSide=selectedSide;$scope.data.nav.left.isOpened=$scope.data.nav.left.isOpened||true;$scope.func.zone[selectedSide]();}}},center:{isOpened:false}},list:[],dbClicked:0,player:{},req:undefined,viewer:{type:null,media:{type:""},pdf:{url:null,changeURL:null,firstSearch:null,isOpenfileShower:false,showIcons:{printer:true},showPDF:false},player:{func:null},html:{content:null},image:{func:null}},activatedItem:null,selectedItems:[],permision:[0,0,0,0],lookupTableType:{"FILE":'document',"FOLDER":'folder'},isNewThumbnailsRequest:false,openedState:{identify:false,note:false,keyword:false,relation:false,history:false}};$scope.func={};/*todo show or hidden icons */$scope.func.sidesShowOrHidden=function(){var countTest=1000;var isReadyDom=setInterval(function(){if(window.document.querySelector('.main-content  .desktop  .btn-group-vertical .taxonomyVisible')||--countTest<=0){clearInterval(isReadyDom);isReadyDom=null;$scope.func.configStateIcons();}},10);};$scope.func.configStateIcons=function(){/*todo navigations icon *//*todo group 1 = {copy,move,purge,rename}*/var group1=false;try{if($scope.data.profile.prfMenu.prfEdit.copyVisible){document.querySelector(".desktop .desktop-navigation span#copyVisibleDesktop").classList.add("showNavIcon");//$scope.data.trees.taxonomy.list.copyFile.show = true;
group1=true;}else{document.querySelector(".desktop .desktop-navigation span#copyVisibleDesktop").classList.remove("showNavIcon");//$scope.data.trees.taxonomy.list.copyFile.show = false;
}}catch(e){console.error(e);}try{if($scope.data.profile.prfMenu.prfEdit.moveVisible){document.querySelector(".desktop .desktop-navigation span#moveVisibleDesktop").classList.add("showNavIcon");group1=true;}else document.querySelector(".desktop .desktop-navigation span#moveVisibleDesktop").classList.remove("showNavIcon");}catch(e){console.error(e);}try{if($scope.data.profile.prfMenu.prfFile.purgeTrashVisible&&$scope.data.nav.right.selectedSide=="trashVisible"||$scope.data.profile.prfMenu.prfEdit.deleteVisible&&$scope.data.nav.right.selectedSide!="trashVisible"){document.querySelector(".desktop .desktop-navigation span#purgeTrashVisibleDesktop").classList.add("showNavIcon");group1=true;}else document.querySelector(".desktop .desktop-navigation span#purgeTrashVisibleDesktop").classList.remove("showNavIcon");}catch(e){console.error(e);}try{if($scope.data.profile.prfMenu.prfEdit.renameVisible){document.querySelector(".desktop .desktop-navigation span#renameVisibleDesktop").classList.add("showNavIcon");group1=true;}else document.querySelector(".desktop .desktop-navigation span#renameVisibleDesktop").classList.remove("showNavIcon");}catch(e){console.error(e);}try{if(group1)document.querySelector(".desktop .desktop-navigation span#group1SpliterDesktop").classList.add("showNavIcon");else document.querySelector(".desktop .desktop-navigation span#group1SpliterDesktop").classList.remove("showNavIcon");}catch(e){console.error(e);}/*todo group 2 = {download,print,about,TOC,exportZip}*/var group2=false;try{if($scope.data.profile.prfMenu.prfFile.downloadVisible){document.querySelector(".desktop .desktop-navigation span#downloadVisibleDesktop").classList.add("showNavIcon");group2=true;}else document.querySelector(".desktop .desktop-navigation span#downloadVisibleDesktop").classList.remove("showNavIcon");}catch(e){console.error(e);}try{if($scope.data.profile.prfToolbar.printVisible){document.querySelector(".desktop .desktop-navigation span#printVisibleDesktop").classList.add("showNavIcon");group2=true;}else document.querySelector(".desktop .desktop-navigation span#printVisibleDesktop").classList.remove("showNavIcon");}catch(e){console.error(e);}try{if($scope.data.profile.prfMenu.prfHelp.aboutVisible){document.querySelector(".desktop .desktop-navigation span#aboutVisibleDesktop").classList.add("showNavIcon");group2=true;}else document.querySelector(".desktop .desktop-navigation span#aboutVisibleDesktop").classList.remove("showNavIcon");}catch(e){console.error(e);}try{if($scope.data.profile.prfMenu.prfHelp.aboutVisible){document.querySelector(".desktop .desktop-navigation span#TOCVisibleDesktop").classList.add("showNavIcon");group2=true;}else document.querySelector(".desktop .desktop-navigation span#TOCVisibleDesktop").classList.remove("showNavIcon");}catch(e){console.error(e);}try{if($scope.data.profile.prfMenu.prfFile.exportVisible){document.querySelector(".desktop .desktop-navigation span#exportVisibleDesktop").classList.add("showNavIcon");group2=true;}else document.querySelector(".desktop .desktop-navigation span#exportVisibleDesktop").classList.remove("showNavIcon");}catch(e){console.error(e);}try{if(group2)document.querySelector(".desktop .desktop-navigation span#group2SpliterDesktop").classList.add("showNavIcon");else document.querySelector(".desktop .desktop-navigation span#group2SpliterDesktop").classList.remove("showNavIcon");}catch(e){console.error(e);}/*todo group 3 = {restore,checkOut,cancelCheckOut,checkIn}*/var group3=false;try{if($scope.data.profile.prfMenu.prfFile.restoreVisible){document.querySelector(".desktop .desktop-navigation span#restoreVisibleDesktop").classList.add("showNavIcon");group3=true;}else document.querySelector(".desktop .desktop-navigation span#restoreVisibleDesktop").classList.remove("showNavIcon");}catch(e){console.error(e);}try{if($scope.data.profile.prfMenu.prfEdit.checkOutVisible){document.querySelector(".desktop .desktop-navigation span#checkOutVisibleDesktop").classList.add("showNavIcon");group3=true;}else document.querySelector(".desktop .desktop-navigation span#checkOutVisibleDesktop").classList.remove("showNavIcon");}catch(e){console.error(e);}try{if($scope.data.profile.prfMenu.prfEdit.cancelCheckOutVisible){document.querySelector(".desktop .desktop-navigation span#cancelCheckOutVisibleDesktop").classList.add("showNavIcon");group3=true;}else document.querySelector(".desktop .desktop-navigation span#cancelCheckOutVisibleDesktop").classList.remove("showNavIcon");}catch(e){console.error(e);}try{if($scope.data.profile.prfMenu.prfEdit.checkInVisible){document.querySelector(".desktop .desktop-navigation span#checkInVisibleDesktop").classList.add("showNavIcon");group3=true;}else document.querySelector(".desktop .desktop-navigation span#checkInVisibleDesktop").classList.remove("showNavIcon");}catch(e){console.error(e);}try{if(group3)document.querySelector(".desktop .desktop-navigation span#group3SpliterDesktop").classList.add("showNavIcon");else document.querySelector(".desktop .desktop-navigation span#group3SpliterDesktop").classList.remove("showNavIcon");}catch(e){console.error(e);}/*todo group 4 = {lock,unlock,forceUnlock}*/var group4=false;try{if($scope.data.profile.prfMenu.prfEdit.lockVisible){document.querySelector(".desktop .desktop-navigation span#lockVisibleDesktop").classList.add("showNavIcon");group4=true;}else document.querySelector(".desktop .desktop-navigation span#lockVisibleDesktop").classList.remove("showNavIcon");}catch(e){console.error(e);}try{if($scope.data.profile.prfMenu.prfEdit.unlockVisible){document.querySelector(".desktop .desktop-navigation span#unlockVisibleDesktop").classList.add("showNavIcon");group4=true;}else document.querySelector(".desktop .desktop-navigation span#unlockVisibleDesktop").classList.remove("showNavIcon");}catch(e){console.error(e);}try{if($scope.data.profile.prfMenu.prfEdit.unlockVisible){document.querySelector(".desktop .desktop-navigation span#forceUnlockVisibleDesktop").classList.add("showNavIcon");group4=true;}else document.querySelector(".desktop .desktop-navigation span#forceUnlockVisibleDesktop").classList.remove("showNavIcon");}catch(e){console.error(e);}try{if(group4)document.querySelector(".desktop .desktop-navigation span#group4SpliterDesktop").classList.add("showNavIcon");else document.querySelector(".desktop .desktop-navigation span#group4SpliterDesktop").classList.remove("showNavIcon");}catch(e){console.error(e);}/*todo group 5 = {addSubscription,removeSubscription,bookmarks}*/var group5=false;try{if($scope.data.profile.prfMenu.prfEdit.addSubscriptionVisible){document.querySelector(".desktop .desktop-navigation span#addSubscriptionVisibleDesktop").classList.add("showNavIcon");group5=true;}else document.querySelector(".desktop .desktop-navigation span#addSubscriptionVisibleDesktop").classList.remove("showNavIcon");}catch(e){console.error(e);}try{if($scope.data.profile.prfMenu.prfEdit.removeSubscriptionVisible){document.querySelector(".desktop .desktop-navigation span#removeSubscriptionVisibleDesktop").classList.add("showNavIcon");group5=true;}else document.querySelector(".desktop .desktop-navigation span#removeSubscriptionVisibleDesktop").classList.remove("showNavIcon");}catch(e){console.error(e);}try{if($scope.data.profile.prfMenu.bookmarksVisible){document.querySelector(".desktop .desktop-navigation span#bookmarksVisibleDesktop").classList.add("showNavIcon");group5=true;}else document.querySelector(".desktop .desktop-navigation span#bookmarksVisibleDesktop").classList.remove("showNavIcon");}catch(e){console.error(e);}try{if(group5)document.querySelector(".desktop .desktop-navigation span#group5SpliterDesktop").classList.add("showNavIcon");else document.querySelector(".desktop .desktop-navigation span#group5SpliterDesktop").classList.remove("showNavIcon");}catch(e){console.error(e);}/*todo group 6 = {addCategory,addWorkFlow,templates,sign,webSite}*/var group6=false;try{if($scope.data.profile.prfMenu.prfEdit.addCategoryVisible){document.querySelector(".desktop .desktop-navigation span#addCategoryVisibleDesktop").classList.add("showNavIcon");group6=true;}else document.querySelector(".desktop .desktop-navigation span#addCategoryVisibleDesktop").classList.remove("showNavIcon");}catch(e){console.error(e);}try{if($scope.data.profile.prfMenu.prfFile.startWorkflowVisible&&$scope.data.profile.prfToolbar.startWorkflowVisible){document.querySelector(".desktop .desktop-navigation span#startWorkflowVisibleDesktop").classList.add("showNavIcon");group6=true;}else document.querySelector(".desktop .desktop-navigation span#startWorkflowVisibleDesktop").classList.remove("showNavIcon");}catch(e){console.error(e);}try{if($scope.data.profile.prfMenu.templatesVisible){document.querySelector(".desktop .desktop-navigation span#templatesVisibleDesktop").classList.add("showNavIcon");group6=true;}else document.querySelector(".desktop .desktop-navigation span#templatesVisibleDesktop").classList.remove("showNavIcon");}catch(e){console.error(e);}try{if($scope.data.profile.prfMenu.templatesVisible){document.querySelector(".desktop .desktop-navigation span#signSelectingDesktop").classList.add("showNavIcon");group6=true;}else document.querySelector(".desktop .desktop-navigation span#signSelectingDesktop").classList.remove("showNavIcon");}catch(e){console.error(e);}try{if($scope.data.profile.prfMenu.prfHelp.webSiteVisible){document.querySelector(".desktop .desktop-navigation span#webSiteVisibleDesktop").classList.add("showNavIcon");group6=true;}else document.querySelector(".desktop .desktop-navigation span#webSiteVisibleDesktop").classList.remove("showNavIcon");}catch(e){console.error(e);}try{if(group6)document.querySelector(".desktop .desktop-navigation span#group6SpliterDesktop").classList.add("showNavIcon");else document.querySelector(".desktop .desktop-navigation span#group6SpliterDesktop").classList.remove("showNavIcon");}catch(e){console.error(e);}/** TODO show or hidden right sides icons **/try{if($scope.data.profile.prfStack.taxonomyVisible)window.document.querySelector('.main-content  .desktop  .btn-group-vertical .taxonomyVisible').style.display='block';else window.document.querySelector('.main-content  .desktop  .btn-group-vertical .taxonomyVisible').style.display='none';}catch(e){console.error(e);}try{if($scope.data.profile.prfStack.categoriesVisible)window.document.querySelector('.main-content  .desktop  .btn-group-vertical .categoriesVisible').style.display='block';else window.document.querySelector('.main-content  .desktop  .btn-group-vertical .categoriesVisible').style.display='none';}catch(e){console.error(e);}try{if($scope.data.profile.prfStack.trashVisible)window.document.querySelector('.main-content  .desktop  .btn-group-vertical .trashVisible').style.display='block';else window.document.querySelector('.main-content  .desktop  .btn-group-vertical .trashVisible').style.display='none';}catch(e){console.error(e);}try{if($scope.data.profile.prfStack.metadataVisible)window.document.querySelector('.main-content  .desktop  .btn-group-vertical .metadataVisible').style.display='block';else window.document.querySelector('.main-content  .desktop  .btn-group-vertical .metadataVisible').style.display='none';}catch(e){console.error(e);}try{if($scope.data.profile.prfMenu.prfHelp.webSiteVisible){window.document.querySelector('.main-content  .desktop  .btn-group-vertical .relationVisible').style.display='block';window.document.querySelector('.main-content  .desktop  .btn-group-vertical .graphVisible').style.display='block';}else{window.document.querySelector('.main-content  .desktop  .btn-group-vertical .relationVisible').style.display='none';window.document.querySelector('.main-content  .desktop  .btn-group-vertical .graphVisible').style.display='none';}}catch(e){console.error(e);}};$scope.func.selectAll=function(){for(var i=0;i<$scope.data.list.length;i++){$scope.data.list[i].selected=false;}if($scope.data.selectAll)_.forEach($scope.data.list,function(item){return $scope.func.choiceItem(item);});else $scope.data.selectedItems=[];_.defer(function(){return $scope.$apply();});};$scope.func.convertArray=function(obj){return typeof obj!=="undefined"?_.isArray(obj)?obj:[obj]:[];};$scope.func.createMetaData=_asyncToGenerator(regeneratorRuntime.mark(function _callee7(){var response;return regeneratorRuntime.wrap(function _callee7$(_context7){while(1){switch(_context7.prev=_context7.next){case 0:_context7.prev=0;_context7.next=3;return JSManagement.addJS('ecma5/ExternalLiberary/Public/createMetaDataFunction.js?dev='+randomVersionName);case 3:_context7.next=5;return JSManagement.addJS('ecma5/ExternalLiberary/Search/dateFormatInternal.js?dev='+randomVersionName);case 5:$scope.data.removeExternalFuncs['ecma5/ExternalLiberary/Search/dateFormatInternal.js?dev='+randomVersionName]='dateFormatInternal';_context7.prev=6;_context7.next=9;return createMetaDataFunction($uibModal,desktopService,dateFormatInternal,JSManagement,CSSManagement,$scope.data.profile);case 9:response=_context7.sent;toaster.pop('success','',response);_context7.next=13;return JSManagement.removeJS('ecma5/ExternalLiberary/Public/createMetaData.js?dev='+randomVersionName,'createMetaDataFunction');case 13:_context7.next=20;break;case 15:_context7.prev=15;_context7.t0=_context7['catch'](6);toaster.pop('error','',_context7.t0);_context7.next=20;return JSManagement.removeJS('ecma5/ExternalLiberary/Public/createMetaData.js?dev='+randomVersionName,'createMetaDataFunction');case 20:_context7.next=26;break;case 22:_context7.prev=22;_context7.t1=_context7['catch'](0);_context7.next=26;return JSManagement.removeJS('ecma5/ExternalLiberary/Public/createMetaData.js?dev='+randomVersionName,'createMetaDataFunction');case 26:case'end':return _context7.stop();}}},_callee7,_this,[[0,22],[6,15]]);}));$scope.func.selectLeftNav=function(){if($scope.data.nav.left.selectedSide!=null)$scope.func.zone[$scope.data.nav.left.selectedSide]();};/** TODO ------------------------- tree and center functions list ----------------------------------- **/$scope.func.runSelectTreeFunction=function(){var _ref8=_asyncToGenerator(regeneratorRuntime.mark(function _callee8(func,currentNode,pointerType,treeType,rootPath){return regeneratorRuntime.wrap(function _callee8$(_context8){while(1){switch(_context8.prev=_context8.next){case 0:if(!_.has($scope.func,func)){_context8.next=4;break;}try{$scope.func[func](currentNode,pointerType,treeType,rootPath);}catch(e){toaster.pop("error","","مشکلی در اجرای درخواست شما به وجود آمده است . لطفا مجددا تلاش کنید .");}finally{_.defer(function(){return $scope.$apply();});}_context8.next=19;break;case 4:_context8.prev=4;_context8.next=7;return JSManagement.addJS('ecma5/ExternalLiberary/Desktop/insideController/functions/'+func+'.js?dev='+randomVersionName);case 7:$scope.data.removeExternalFuncs['ecma5/ExternalLiberary/Desktop/insideController/functions/'+func+'.js?dev='+randomVersionName]=func+'DesktopCtrl';_context8.next=10;return window[func+'DesktopCtrl']($scope,desktopService,JSManagement,CSSManagement,toaster,$uibModal);case 10:$scope.func[func](currentNode,pointerType,treeType,rootPath);_context8.next=16;break;case 13:_context8.prev=13;_context8.t0=_context8['catch'](4);console.error(_context8.t0);case 16:_context8.prev=16;_.defer(function(){return $scope.$apply();});return _context8.finish(16);case 19:case'end':return _context8.stop();}}},_callee8,_this,[[4,13,16,19]]);}));return function(_x17,_x18,_x19,_x20,_x21){return _ref8.apply(this,arguments);};}();/** TODO ------------------------- Close or Open -------------------------------------------------- **/$scope.func.closeOrOpenLeft=function(){$scope.data.nav.left.isOpened=!$scope.data.nav.left.isOpened;if(!$scope.data.nav.left.isOpened&&$scope.data.nav.left.selectedSide!=null){window.document.querySelector('.D div.'+$scope.data.nav.left.selectedSide).classList.remove("show");}else{window.document.querySelector('.D div.'+$scope.data.nav.left.selectedSide).classList.add("show");}};$scope.func.closeOrOpenRight=function(){$scope.data.nav.right.isOpened=!$scope.data.nav.right.isOpened;if(!$scope.data.nav.right.isOpened&&$scope.data.nav.right.selectedSide!=null){window.document.querySelector('.D div.'+$scope.data.nav.right.selectedSide).classList.remove("show");}else{window.document.querySelector('.D div.'+$scope.data.nav.right.selectedSide).classList.add("show");}};$scope.func.compareDocs=function(){console.log('----------lava--');console.log($scope.data.selectedItems[0]);if($scope.data.selectedItems!=null){console.log('----------lava--');window.open('/compare/?docIds='+ _.map($scope.data.selectedItems, 'uuid').join(',') + '&token='+ decodeURIComponent(isCookieFunction("Authorization").replace('Bearer', '')), '_blank');}};/** TODO ------------------------- center icons navigation list ----------------------------------- **/$scope.func.runSelectFunction=function(){var _ref9=_asyncToGenerator(regeneratorRuntime.mark(function _callee9(func){return regeneratorRuntime.wrap(function _callee9$(_context9){while(1){switch(_context9.prev=_context9.next){case 0:console.info(func);_context9.prev=1;$scope.func[func]();_context9.next=23;break;case 5:_context9.prev=5;_context9.t0=_context9['catch'](1);console.error(_context9.t0);_context9.prev=8;_context9.next=11;return JSManagement.addJS('ecma5/ExternalLiberary/Desktop/insideController/functions/'+func+'.js?dev='+randomVersionName);case 11:$scope.data.removeExternalFuncs['ecma5/ExternalLiberary/Desktop/insideController/functions/'+func+'.js?dev='+randomVersionName]=func+'DesktopCtrl';_context9.next=14;return window[func+'DesktopCtrl']($scope,desktopService,JSManagement,CSSManagement,toaster,$uibModal,userInfoService,Authentication);case 14:$scope.func[func]();_context9.next=20;break;case 17:_context9.prev=17;_context9.t1=_context9['catch'](8);console.error(_context9.t1);case 20:_context9.prev=20;_.defer(function(){return $scope.$apply();});return _context9.finish(20);case 23:case'end':return _context9.stop();}}},_callee9,_this,[[1,5],[8,17,20,23]]);}));return function(_x22){return _ref9.apply(this,arguments);};}();$scope.func.runWithEventSelectFunction=function(){var _ref10=_asyncToGenerator(regeneratorRuntime.mark(function _callee10(evt,func){return regeneratorRuntime.wrap(function _callee10$(_context10){while(1){switch(_context10.prev=_context10.next){case 0:_context10.prev=0;$scope.func[func](evt);_context10.next=22;break;case 4:_context10.prev=4;_context10.t0=_context10['catch'](0);console.error(_context10.t0);_context10.prev=7;_context10.next=10;return JSManagement.addJS('ecma5/ExternalLiberary/Desktop/insideController/functions/'+func+'.js?dev='+randomVersionName);case 10:$scope.data.removeExternalFuncs['ecma5/ExternalLiberary/Desktop/insideController/functions/'+func+'.js?dev='+randomVersionName]=func+'DesktopCtrl';_context10.next=13;return window[func+'DesktopCtrl']($scope,desktopService,JSManagement,CSSManagement,toaster,$uibModal);case 13:$scope.func[func](evt);_context10.next=19;break;case 16:_context10.prev=16;_context10.t1=_context10['catch'](7);console.error(_context10.t1);case 19:_context10.prev=19;_.defer(function(){return $scope.$apply();});return _context10.finish(19);case 22:case'end':return _context10.stop();}}},_callee10,_this,[[0,4],[7,16,19,22]]);}));return function(_x23,_x24){return _ref10.apply(this,arguments);};}();/** TODO ------------------------- generate abstract path ------------------------------- **/$scope.func.generateAbstractPath=function(){var _ref11=_asyncToGenerator(regeneratorRuntime.mark(function _callee11(path,doc,isOpen){var res;return regeneratorRuntime.wrap(function _callee11$(_context11){while(1){switch(_context11.prev=_context11.next){case 0:_context11.prev=0;_context11.next=3;return JSManagement.addJS('ecma5/ExternalLiberary/Public/abstractPath.js?dev='+randomVersionName);case 3:$scope.data.removeExternalFuncs['ecma5/ExternalLiberary/Public/abstractPath.js?dev='+randomVersionName]='abstractPath';$scope.data.trees.taxonomyVisible=$scope.data.trees.taxonomyVisible||[];if(typeof doc!=="undefined"&&_.has(doc,'mimeType')){//var fileName = _.remove( _.split(doc.path,'/') , i => i!="").splice(-1);
path=path.substring(0,path.lastIndexOf("/"));}_context11.next=8;return abstractPath(path,//"/okm:root/dest/d1/d2/t2 (2)/t4/",
desktopService,$scope.data.trees.taxonomyVisible,$scope.data.trees.taxonomyTree,$scope.data.pointers["taxonomyVisible"],$scope.data.nodesFolder,'taxonomy');case 8:res=_context11.sent;_.defer(function(){return $scope.$apply();});if(typeof isOpen!=="undefined"){try{window.document.querySelector('.D div.taxonomyVisible').classList.add("show");}catch(error){console.error(error);}}$scope.data.trees.taxonomyVisible=res.tree;$scope.data.trees.taxonomy.changeCurrentNode($scope.data.pointers["taxonomyVisible"][res.id],false,doc);_context11.next=18;break;case 15:_context11.prev=15;_context11.t0=_context11['catch'](0);console.error(_context11.t0);case 18:case'end':return _context11.stop();}}},_callee11,_this,[[0,15]]);}));return function(_x25,_x26,_x27){return _ref11.apply(this,arguments);};}();$scope.func.generateAbstractPathMetaData=function(){var _ref12=_asyncToGenerator(regeneratorRuntime.mark(function _callee12(path,doc){var res;return regeneratorRuntime.wrap(function _callee12$(_context12){while(1){switch(_context12.prev=_context12.next){case 0:_context12.prev=0;_context12.next=3;return JSManagement.addJS('ecma5/ExternalLiberary/Public/abstractPath.js?dev='+randomVersionName);case 3:$scope.data.removeExternalFuncs['ecma5/ExternalLiberary/Public/abstractPath.js?dev='+randomVersionName]='abstractPath';$scope.data.trees.metadataVisible=$scope.data.trees.metadataVisible||[];if(typeof doc!=="undefined"&&_.has(doc,'mimeType')){//var fileName = _.remove( _.split(doc.path,'/') , i => i!="").splice(-1);
path=path.substring(0,path.lastIndexOf("/"));}_context12.next=8;return abstractPath(path,//"/okm:root/dest/d1/d2/t2 (2)/t4/",
desktopService,$scope.data.trees.metadataVisible,$scope.data.trees.metadataVisible,$scope.data.pointers["metadataVisible"],$scope.data.nodesFolder,"metadata");case 8:res=_context12.sent;_.defer(function(){return $scope.$apply();});$scope.data.trees.metadataVisible=res.tree;$scope.data.trees.metadata.changeCurrentNode($scope.data.pointers["metadataVisible"][res.id],false,doc);_context12.next=17;break;case 14:_context12.prev=14;_context12.t0=_context12['catch'](0);console.error(_context12.t0);case 17:case'end':return _context12.stop();}}},_callee12,_this,[[0,14]]);}));return function(_x28,_x29){return _ref12.apply(this,arguments);};}();$scope.func.clickInDoc=function(){var _ref13=_asyncToGenerator(regeneratorRuntime.mark(function _callee13(doc,isClick){return regeneratorRuntime.wrap(function _callee13$(_context13){while(1){switch(_context13.prev=_context13.next){case 0:if(typeof isClick==="undefined"){$scope.func.selectLeftNav();}try{$scope.func.stopAllPlayers();}catch(e){console.error(e);}try{if(doc.type=='FILE'){if(doc.group=="trash")toaster.pop('error','','امکان نمایش سند های داخل سطل زباله نیست');else $scope.func.showFile(doc);}}catch(e){console.error(e);}case 3:case'end':return _context13.stop();}}},_callee13,_this);}));return function(_x30,_x31){return _ref13.apply(this,arguments);};}();$scope.func.clickImage=function(e,doc){$scope.data.dbClicked=e.detail||e.originalEvent.detail;$scope.data.selectedFileOrFolder=_.clone(doc);$scope.func.stopAllPlayers();$scope.func.selectLeftNav();switch($scope.data.dbClicked){case 1:/* TODO click in image */setTimeout(function(){if($scope.data.dbClicked==1){$scope.data.dbClicked=0;$scope.func.clickInDoc(doc,true);}},500);break;case 2:/* TODO double click in image */$scope.func.dbClickInDoc(doc);break;default:break;}};$scope.func.choiceItem=function(){var _ref14=_asyncToGenerator(regeneratorRuntime.mark(function _callee15(doc){return regeneratorRuntime.wrap(function _callee15$(_context15){while(1){switch(_context15.prev=_context15.next){case 0:doc.selected=!doc.selected;_context15.next=3;return JSManagement.addJS('ecma5/ExternalLiberary/Public/getPermisionArray.js?dev='+randomVersionName);case 3:$scope.data.removeExternalFuncs['ecma5/ExternalLiberary/Public/getPermisionArray.js?dev='+randomVersionName]='getPermisionArray';if(!doc.selected){_context15.next=8;break;}(function(){var permisionArray=typeof doc.permissions!=="undefined"?getPermisionArray(doc.permissions):null;if(permisionArray!=null)$scope.data.permision=$scope.data.selectedItems.length==0?permisionArray:_.map($scope.data.permision,function(v,i){return v=v==0?v:permisionArray[i];});if(_.isEmpty(_.filter($scope.data.selectedItems,function(selected){return selected.uuid==doc.uuid;})))$scope.data.selectedItems.push(doc);})();_context15.next=14;break;case 8:_.remove($scope.data.selectedItems,function(_doc){return _doc.uuid==doc.uuid;});if(!($scope.data.selectedItems.length>1)){_context15.next=13;break;}return _context15.delegateYield(regeneratorRuntime.mark(function _callee14(){var permision;return regeneratorRuntime.wrap(function _callee14$(_context14){while(1){switch(_context14.prev=_context14.next){case 0:_context14.next=2;return JSManagement.addJS('ecma5/ExternalLiberary/Public/comparePermisions.js?dev='+randomVersionName);case 2:$scope.data.removeExternalFuncs['ecma5/ExternalLiberary/Public/comparePermisions.js?dev='+randomVersionName]='comparePermisions';permision=_.filter($scope.data.selectedItems,'permissions').length>=1?[1,1,1,1]:[0,0,0,0];_.forEach(_.map(_.filter($scope.data.selectedItems,'permissions'),function(i){return getPermisionArray(i);}),function(item){permision=comparePermisions(permision,item);});$scope.data.permision=angular.copy(permision);case 6:case'end':return _context14.stop();}}},_callee14,_this);})(),'t0',11);case 11:_context15.next=14;break;case 13:if($scope.data.selectedItems.length==1)$scope.data.permision=typeof $scope.data.selectedItems[0].permissions!="undefined"?getPermisionArray($scope.data.selectedItems[0].permissions):[0,0,0,0];else if($scope.data.selectedItems.length==0)$scope.data.permision=[0,0,0,0];case 14:case'end':return _context15.stop();}}},_callee15,_this);}));return function(_x32){return _ref14.apply(this,arguments);};}();$scope.func.dbClickInDoc=function(){var _ref15=_asyncToGenerator(regeneratorRuntime.mark(function _callee16(doc){return regeneratorRuntime.wrap(function _callee16$(_context16){while(1){switch(_context16.prev=_context16.next){case 0:_context16.prev=0;$scope.func.doubleClickInDoc(doc);_context16.next=22;break;case 4:_context16.prev=4;_context16.t0=_context16['catch'](0);console.error(_context16.t0);_context16.prev=7;_context16.next=10;return JSManagement.addJS('ecma5/ExternalLiberary/Desktop/insideController/functions/doubleClickInDoc.js?dev='+randomVersionName);case 10:$scope.data.removeExternalFuncs['ecma5/ExternalLiberary/Desktop/insideController/functions/doubleClickInDoc.js?dev='+randomVersionName]='doubleClickInDocDesktopCtrl';_context16.next=13;return doubleClickInDocDesktopCtrl($scope,desktopService,JSManagement,CSSManagement,toaster,$uibModal);case 13:$scope.func.doubleClickInDoc(doc);_context16.next=19;break;case 16:_context16.prev=16;_context16.t1=_context16['catch'](7);console.error(_context16.t1);case 19:_context16.prev=19;_.defer(function(){return $scope.$apply();});return _context16.finish(19);case 22:case'end':return _context16.stop();}}},_callee16,_this,[[0,4],[7,16,19,22]]);}));return function(_x33){return _ref15.apply(this,arguments);};}();/** TODO ------------------------- refresh trees info functions ------------------------- **/$scope.func.refreshTaxonomy=_asyncToGenerator(regeneratorRuntime.mark(function _callee17(){return regeneratorRuntime.wrap(function _callee17$(_context17){while(1){switch(_context17.prev=_context17.next){case 0:_context17.prev=0;$scope.data.nodesFolder=undefined;$scope.data.nodesFolder={};$scope.data.trees.taxonomyVisible=undefined;$scope.data.pointers["taxonomyVisible"]=undefined;$scope.data.pointers["taxonomyVisible"]={};desktopService.repository.getRoot('getRootFolder').then(function(result){result.data[0].type="FOLDER";result.data[0].group="taxonomy";$scope.data.trees.taxonomyVisible=_.clone(result.data);$scope.data.pointers["taxonomyVisible"][result.data[0].id]=$scope.data.trees.taxonomyVisible[0];$scope.data.nodesFolder[result.data[0].path]=$scope.data.trees.taxonomyVisible[0];},function(error){return toaster.pop('error','','عدم دریافت موفقیت آمیز ریشه');});_context17.next=9;return JSManagement.addJS('ecma5/ExternalLiberary/Public/removeAllPlayers.js?dev='+randomVersionName);case 9:$scope.data.removeExternalFuncs['ecma5/ExternalLiberary/Public/removeAllPlayers.js?dev='+randomVersionName]='removeAllPlayers';removeAllPlayers();$scope.data.viewer.pdf.isOpenfileShower=false;$scope.data.list=[];$scope.data.selectedItems=[];_.defer(function(){return $scope.$apply();});_context17.next=20;break;case 17:_context17.prev=17;_context17.t0=_context17['catch'](0);console.error(_context17.t0);case 20:case'end':return _context17.stop();}}},_callee17,_this,[[0,17]]);}));$scope.func.refreshMetaData=function(){$scope.data.trees.metadataVisible=undefined;$scope.data.trees.metadataVisible=[{prop:$translate.instant('search.zm.tree_frequency_metadata'),isLast:false,hasChildrenFolder:true,request:'getTreeAllRoot',rootFolder:[],queryList:[],collapsed:true,children:[],label:$translate.instant('search.zm.tree_frequency_metadata'),id:'root',type:"FOLDER",group:"metadata",uuid:'root'}];$scope.data.pointers["metadataVisible"]=undefined;$scope.data.pointers["metadataVisible"]={};$scope.data.pointers["metadataVisible"].root=$scope.data.trees.metadataVisible[0];$scope.data.list=[];$scope.data.selectedItems=[];_.defer(function(){return $scope.$apply();});};$scope.func.refreshTrash=_asyncToGenerator(regeneratorRuntime.mark(function _callee18(){return regeneratorRuntime.wrap(function _callee18$(_context18){while(1){switch(_context18.prev=_context18.next){case 0:_context18.prev=0;$scope.data.trees.trashVisible=undefined;$scope.data.pointers["trashVisible"]=undefined;$scope.data.pointers["trashVisible"]={};desktopService.repository.getRoot('getUserTrashFolder').then(function(result){result.data[0].type="FOLDER";result.data[0].group="trash";$scope.data.trees.trashVisible=_.clone(result.data);$scope.data.pointers["trashVisible"][result.data[0].id]=$scope.data.trees.trashVisible[0];$scope.data.nodesFolder[result.data[0].path]=$scope.data.trees.trashVisible[0];},function(error){return toaster.pop('error','','عدم دریافت موفقیت آمیز ریشه');});_context18.next=7;return JSManagement.addJS('ecma5/ExternalLiberary/Public/removeAllPlayers.js?dev='+randomVersionName);case 7:$scope.data.removeExternalFuncs['ecma5/ExternalLiberary/Public/removeAllPlayers.js?dev='+randomVersionName]='removeAllPlayers';removeAllPlayers();$scope.data.viewer.pdf.isOpenfileShower=false;$scope.data.list=[];$scope.data.selectedItems=[];_.defer(function(){return $scope.$apply();});_context18.next=18;break;case 15:_context18.prev=15;_context18.t0=_context18['catch'](0);console.error(_context18.t0);case 18:case'end':return _context18.stop();}}},_callee18,_this,[[0,15]]);}));$scope.func.refreshCategory=_asyncToGenerator(regeneratorRuntime.mark(function _callee19(){return regeneratorRuntime.wrap(function _callee19$(_context19){while(1){switch(_context19.prev=_context19.next){case 0:_context19.prev=0;$scope.data.trees.categoryVisible=undefined;$scope.data.pointers["categoryVisible"]=undefined;$scope.data.pointers["categoryVisible"]={};desktopService.repository.getRoot('getCategoriesFolder').then(function(result){result.data[0].type="FOLDER";result.data[0].group="category";$scope.data.trees.categoryVisible=_.clone(result.data);$scope.data.pointers["categoryVisible"][result.data[0].id]=$scope.data.trees.categoryVisible[0];$scope.data.nodesFolder[result.data[0].path]=$scope.data.trees.categoryVisible[0];},function(error){return toaster.pop('error','','عدم دریافت موفقیت آمیز ریشه');});_context19.next=7;return JSManagement.addJS('ecma5/ExternalLiberary/Public/removeAllPlayers.js?dev='+randomVersionName);case 7:$scope.data.removeExternalFuncs['ecma5/ExternalLiberary/Public/removeAllPlayers.js?dev='+randomVersionName]='removeAllPlayers';removeAllPlayers();$scope.data.viewer.pdf.isOpenfileShower=false;$scope.data.list=[];$scope.data.selectedItems=[];_.defer(function(){return $scope.$apply();});_context19.next=18;break;case 15:_context19.prev=15;_context19.t0=_context19['catch'](0);console.error(_context19.t0);case 18:case'end':return _context19.stop();}}},_callee19,_this,[[0,15]]);}));$scope.func.refreshTemplates=_asyncToGenerator(regeneratorRuntime.mark(function _callee20(){return regeneratorRuntime.wrap(function _callee20$(_context20){while(1){switch(_context20.prev=_context20.next){case 0:_context20.prev=0;$scope.data.nodesFolder=undefined;$scope.data.nodesFolder={};$scope.data.trees.templatesVisible=undefined;$scope.data.pointers["templatesVisible"]=undefined;$scope.data.pointers["templatesVisible"]={};desktopService.repository.getRoot('getTemplatesFolder').then(function(result){result.data[0].type="FOLDER";result.data[0].group="templates";$scope.data.trees.templatesVisible=_.clone(result.data);$scope.data.pointers["templatesVisible"][result.data[0].id]=$scope.data.trees.templatesVisible[0];$scope.data.nodesFolder[result.data[0].path]=$scope.data.trees.templatesVisible[0];},function(error){return toaster.pop('error','','عدم دریافت موفقیت آمیز ریشه');});_context20.next=9;return JSManagement.addJS('ecma5/ExternalLiberary/Public/removeAllPlayers.js?dev='+randomVersionName);case 9:$scope.data.removeExternalFuncs['ecma5/ExternalLiberary/Public/removeAllPlayers.js?dev='+randomVersionName]='removeAllPlayers';removeAllPlayers();$scope.data.viewer.pdf.isOpenfileShower=false;$scope.data.list=[];$scope.data.selectedItems=[];_.defer(function(){return $scope.$apply();});_context20.next=20;break;case 17:_context20.prev=17;_context20.t0=_context20['catch'](0);console.error(_context20.t0);case 20:case'end':return _context20.stop();}}},_callee20,_this,[[0,17]]);}));$scope.func.refreshPersonal=_asyncToGenerator(regeneratorRuntime.mark(function _callee21(){return regeneratorRuntime.wrap(function _callee21$(_context21){while(1){switch(_context21.prev=_context21.next){case 0:_context21.prev=0;$scope.data.nodesFolder=undefined;$scope.data.nodesFolder={};$scope.data.trees.personalVisible=undefined;$scope.data.pointers["personalVisible"]=undefined;$scope.data.pointers["personalVisible"]={};desktopService.repository.getRoot('getUserPersonalFolder').then(function(result){result.data[0].type="FOLDER";result.data[0].group="personal";$scope.data.trees.personalVisible=_.clone(result.data);$scope.data.pointers["personalVisible"][result.data[0].id]=$scope.data.trees.personalVisible[0];$scope.data.nodesFolder[result.data[0].path]=$scope.data.trees.personalVisible[0];},function(error){return toaster.pop('error','','عدم دریافت موفقیت آمیز ریشه');});_context21.next=9;return JSManagement.addJS('ecma5/ExternalLiberary/Public/removeAllPlayers.js?dev='+randomVersionName);case 9:$scope.data.removeExternalFuncs['ecma5/ExternalLiberary/Public/removeAllPlayers.js?dev='+randomVersionName]='removeAllPlayers';removeAllPlayers();$scope.data.viewer.pdf.isOpenfileShower=false;$scope.data.list=[];$scope.data.selectedItems=[];_.defer(function(){return $scope.$apply();});_context21.next=20;break;case 17:_context21.prev=17;_context21.t0=_context21['catch'](0);console.error(_context21.t0);case 20:case'end':return _context21.stop();}}},_callee21,_this,[[0,17]]);}));$scope.func.stopAllPlayers=_asyncToGenerator(regeneratorRuntime.mark(function _callee22(){return regeneratorRuntime.wrap(function _callee22$(_context22){while(1){switch(_context22.prev=_context22.next){case 0:_context22.next=2;return JSManagement.addJS('ecma5/ExternalLiberary/Public/removeAllPlayers.js?dev='+randomVersionName);case 2:$scope.data.removeExternalFuncs['ecma5/ExternalLiberary/Public/removeAllPlayers.js?dev='+randomVersionName]='removeAllPlayers';removeAllPlayers();$scope.data.viewer.type=null;_.defer(function(){return $scope.$apply();});case 6:case'end':return _context22.stop();}}},_callee22,_this);}));$scope.func.showFile=function(){var _ref22=_asyncToGenerator(regeneratorRuntime.mark(function _callee23(doc){return regeneratorRuntime.wrap(function _callee23$(_context23){while(1){switch(_context23.prev=_context23.next){case 0:_context23.prev=0;$scope.func.showDocumentsAndFolder(doc);_context23.next=22;break;case 4:_context23.prev=4;_context23.t0=_context23['catch'](0);console.error(_context23.t0);_context23.prev=7;_context23.next=10;return JSManagement.addJS('ecma5/ExternalLiberary/Desktop/insideController/functions/showDocumentsAndFolder.js?dev='+randomVersionName);case 10:$scope.data.removeExternalFuncs['ecma5/ExternalLiberary/Desktop/insideController/functions/showDocumentsAndFolder.js?dev='+randomVersionName]='showDocumentsAndFolderDesktopCtrl';_context23.next=13;return showDocumentsAndFolderDesktopCtrl($scope,desktopService,JSManagement,CSSManagement,toaster,$uibModal);case 13:$scope.func.showDocumentsAndFolder(doc);_context23.next=19;break;case 16:_context23.prev=16;_context23.t1=_context23['catch'](7);console.error(_context23.t1);case 19:_context23.prev=19;_.defer(function(){return $scope.$apply();});return _context23.finish(19);case 22:case'end':return _context23.stop();}}},_callee23,_this,[[0,4],[7,16,19,22]]);}));return function(_x34){return _ref22.apply(this,arguments);};}();$scope.func.getThumbnailFile=function(file,getSrcFromType){return new Promise(function(resolve,reject){try{desktopService.document.thumbnail(file,0,75).then(function(result){if(_.has(result.data,'originalElement')&&_.isEqual(result.data.originalElement,{}))resolve(getSrcFromType(file.mimeType));resolve("data:image/png;base64,"+result.data);},function(error){return resolve(getSrcFromType(file.mimeType));});}catch(e){console.error(e);resolve(getSrcFromType(file.mimeType));}});};$scope.func.getImage=function(){var _ref23=_asyncToGenerator(regeneratorRuntime.mark(function _callee24(list){var i;return regeneratorRuntime.wrap(function _callee24$(_context24){while(1){switch(_context24.prev=_context24.next){case 0:_context24.prev=0;_context24.next=3;return JSManagement.addJS('ecma5/ExternalLiberary/Public/getSrcFromType.js?dev='+randomVersionName);case 3:$scope.data.removeExternalFuncs['ecma5/ExternalLiberary/Public/getSrcFromType.js?dev='+randomVersionName]='getSrcFromType';i=0;case 5:if(!(i<list.length)){_context24.next=24;break;}if(!($scope.data.isNewThumbnailsRequest==true)){_context24.next=8;break;}throw new Error("Stopping get Thumbnail function!");case 8:_context24.prev=8;if(!(_.has(list[i],"type")&&_.toUpper(list[i].type)=="FILE")){_context24.next=13;break;}_context24.next=12;return $scope.func.getThumbnailFile(list[i],getSrcFromType);case 12:list[i].thumbnailSrc=_context24.sent;case 13:_context24.next=18;break;case 15:_context24.prev=15;_context24.t0=_context24['catch'](8);console.error(_context24.t0);case 18:_context24.prev=18;_.defer(function(){return $scope.$apply();});return _context24.finish(18);case 21:i++;_context24.next=5;break;case 24:$scope.data.isNewThumbnailsRequest=false;_context24.next=30;break;case 27:_context24.prev=27;_context24.t1=_context24['catch'](0);console.error(_context24.t1.message||_context24.t1);case 30:case'end':return _context24.stop();}}},_callee24,_this,[[0,27],[8,15,18,21]]);}));return function(_x35){return _ref23.apply(this,arguments);};}();$scope.func.selectFolder=function(){var _ref24=_asyncToGenerator(regeneratorRuntime.mark(function _callee25(folder,search,selectedDoc){return regeneratorRuntime.wrap(function _callee25$(_context25){while(1){switch(_context25.prev=_context25.next){case 0:_context25.prev=0;$scope.func.selectingFolder(folder,search,selectedDoc);_context25.next=22;break;case 4:_context25.prev=4;_context25.t0=_context25['catch'](0);console.error(_context25.t0);_context25.prev=7;_context25.next=10;return JSManagement.addJS('ecma5/ExternalLiberary/Desktop/insideController/functions/selectingFolder.js?dev='+randomVersionName);case 10:$scope.data.removeExternalFuncs['ecma5/ExternalLiberary/Desktop/insideController/functions/selectingFolder.js?dev='+randomVersionName]='selectingFolderDesktopCtrl';_context25.next=13;return selectingFolderDesktopCtrl($scope,desktopService,JSManagement,CSSManagement,toaster,$uibModal);case 13:$scope.func.selectingFolder(folder,search,selectedDoc);_context25.next=19;break;case 16:_context25.prev=16;_context25.t1=_context25['catch'](7);console.error(_context25.t1);case 19:_context25.prev=19;_.defer(function(){return $scope.$apply();});return _context25.finish(19);case 22:case'end':return _context25.stop();}}},_callee25,_this,[[0,4],[7,16,19,22]]);}));return function(_x36,_x37,_x38){return _ref24.apply(this,arguments);};}();$scope.func.nav={};$scope.func.nav.copy=_asyncToGenerator(regeneratorRuntime.mark(function _callee26(){return regeneratorRuntime.wrap(function _callee26$(_context26){while(1){switch(_context26.prev=_context26.next){case 0:_context26.prev=0;$scope.func.navCopy();_context26.next=22;break;case 4:_context26.prev=4;_context26.t0=_context26['catch'](0);console.error(_context26.t0);_context26.prev=7;_context26.next=10;return JSManagement.addJS('ecma5/ExternalLiberary/Desktop/insideController/functions/navCopy.js?dev='+randomVersionName);case 10:$scope.data.removeExternalFuncs['ecma5/ExternalLiberary/Desktop/insideController/functions/navCopy.js?dev='+randomVersionName]='navCopyDesktopCtrl';_context26.next=13;return navCopyDesktopCtrl($scope,desktopService,JSManagement,CSSManagement,toaster,$uibModal);case 13:$scope.func.navCopy();_context26.next=19;break;case 16:_context26.prev=16;_context26.t1=_context26['catch'](7);console.error(_context26.t1);case 19:_context26.prev=19;_.defer(function(){return $scope.$apply();});return _context26.finish(19);case 22:case'end':return _context26.stop();}}},_callee26,_this,[[0,4],[7,16,19,22]]);}));$scope.func.showLeftItems=function(type){$scope.data.isShowItem=type!='trash';_.defer(function(){return $scope.$apply();});};$scope.func.clearBeforeInput=function(){return new Promise(function(resolve,reject){try{$scope.func.stopAllPlayers();$scope.data.list=[];$scope.data.selectedItems=[];$scope.data.selectedFileOrFolder=null;_.defer(function(){return $scope.$apply(resolve(true));});}catch(e){reject(e);}});};$scope.func.createNewMetaData=function(){var _ref26=_asyncToGenerator(regeneratorRuntime.mark(function _callee27(node){return regeneratorRuntime.wrap(function _callee27$(_context27){while(1){switch(_context27.prev=_context27.next){case 0:_context27.prev=0;$scope.func.createNewMetaDataItem(node);_context27.next=22;break;case 4:_context27.prev=4;_context27.t0=_context27['catch'](0);console.error(_context27.t0);_context27.prev=7;_context27.next=10;return JSManagement.addJS('ecma5/ExternalLiberary/Desktop/insideController/functions/createNewMetaDataItem.js?dev='+randomVersionName);case 10:$scope.data.removeExternalFuncs['ecma5/ExternalLiberary/Desktop/insideController/functions/createNewMetaDataItem.js?dev='+randomVersionName]='createNewMetaDataItemDesktopCtrl';_context27.next=13;return createNewMetaDataItemDesktopCtrl($scope,desktopService,JSManagement,CSSManagement,toaster,$uibModal);case 13:$scope.func.createNewMetaDataItem(node);_context27.next=19;break;case 16:_context27.prev=16;_context27.t1=_context27['catch'](7);console.error(_context27.t1);case 19:_context27.prev=19;_.defer(function(){return $scope.$apply();});return _context27.finish(19);case 22:case'end':return _context27.stop();}}},_callee27,_this,[[0,4],[7,16,19,22]]);}));return function(_x39){return _ref26.apply(this,arguments);};}();$scope.func.zone={/*todo LEFT */identifyVisible:function(){var _ref27=_asyncToGenerator(regeneratorRuntime.mark(function _callee28(){return regeneratorRuntime.wrap(function _callee28$(_context28){while(1){switch(_context28.prev=_context28.next){case 0:_context28.prev=0;if($scope.data.openedState.identify){_context28.next=19;break;}_context28.prev=2;_context28.next=5;return JSManagement.addJS('ecma5/ExternalLiberary/Desktop/insideController/identify.js?dev='+randomVersionName);case 5:$scope.data.removeExternalFuncs['ecma5/ExternalLiberary/Desktop/insideController/identify.js?dev='+randomVersionName]='addIdentifySection2DesktopCtrl';_context28.next=8;return addIdentifySection2DesktopCtrl($scope,desktopService,JSManagement,toaster,$uibModal);case 8:$scope.data.openedState.identify=true;_context28.next=16;break;case 11:_context28.prev=11;_context28.t0=_context28['catch'](2);console.error(_context28.t0);toaster.pop("error","",_context28.t0||_context28.t0.message);return _context28.abrupt('return');case 16:_context28.prev=16;_.defer(function(){return $scope.$apply();});return _context28.finish(16);case 19:$scope.func.runIdentify();_context28.next=25;break;case 22:_context28.prev=22;_context28.t1=_context28['catch'](0);console.error(_context28.t1);case 25:case'end':return _context28.stop();}}},_callee28,_this,[[0,22],[2,11,16,19]]);}));function identifyVisible(){return _ref27.apply(this,arguments);}return identifyVisible;}(),keywordVisible:function(){var _ref28=_asyncToGenerator(regeneratorRuntime.mark(function _callee29(){return regeneratorRuntime.wrap(function _callee29$(_context29){while(1){switch(_context29.prev=_context29.next){case 0:_context29.prev=0;if($scope.data.openedState.keyword){_context29.next=19;break;}_context29.prev=2;_context29.next=5;return JSManagement.addJS('ecma5/ExternalLiberary/Desktop/insideController/keyword.js?dev='+randomVersionName);case 5:$scope.data.removeExternalFuncs['ecma5/ExternalLiberary/Desktop/insideController/keyword.js?dev='+randomVersionName]='addKeywordSection2DesktopCtrl';_context29.next=8;return addKeywordSection2DesktopCtrl($scope,desktopService,JSManagement,toaster,$uibModal);case 8:$scope.data.openedState.keyword=true;_context29.next=16;break;case 11:_context29.prev=11;_context29.t0=_context29['catch'](2);console.error(_context29.t0);toaster.pop("error","",_context29.t0||_context29.t0.message);return _context29.abrupt('return');case 16:_context29.prev=16;_.defer(function(){return $scope.$apply();});return _context29.finish(16);case 19:$scope.func.runKeyword();_context29.next=25;break;case 22:_context29.prev=22;_context29.t1=_context29['catch'](0);console.error(_context29.t1);case 25:case'end':return _context29.stop();}}},_callee29,_this,[[0,22],[2,11,16,19]]);}));function keywordVisible(){return _ref28.apply(this,arguments);}return keywordVisible;}(),noteVisible:function(){var _ref29=_asyncToGenerator(regeneratorRuntime.mark(function _callee30(){return regeneratorRuntime.wrap(function _callee30$(_context30){while(1){switch(_context30.prev=_context30.next){case 0:_context30.prev=0;if($scope.data.openedState.note){_context30.next=19;break;}_context30.prev=2;_context30.next=5;return JSManagement.addJS('ecma5/ExternalLiberary/Desktop/insideController/note.js?dev='+randomVersionName);case 5:$scope.data.removeExternalFuncs['ecma5/ExternalLiberary/Desktop/insideController/note.js?dev='+randomVersionName]='addNoteSection2DesktopCtrl';_context30.next=8;return addNoteSection2DesktopCtrl($scope,desktopService,JSManagement,toaster,$uibModal);case 8:$scope.data.openedState.note=true;_context30.next=16;break;case 11:_context30.prev=11;_context30.t0=_context30['catch'](2);console.error(_context30.t0);toaster.pop("error","",_context30.t0||_context30.t0.message);return _context30.abrupt('return');case 16:_context30.prev=16;_.defer(function(){return $scope.$apply();});return _context30.finish(16);case 19:$scope.func.runNote();_context30.next=25;break;case 22:_context30.prev=22;_context30.t1=_context30['catch'](0);console.error(_context30.t1);case 25:case'end':return _context30.stop();}}},_callee30,_this,[[0,22],[2,11,16,19]]);}));function noteVisible(){return _ref29.apply(this,arguments);}return noteVisible;}(),securityVisible:function(){var _ref30=_asyncToGenerator(regeneratorRuntime.mark(function _callee31(){return regeneratorRuntime.wrap(function _callee31$(_context31){while(1){switch(_context31.prev=_context31.next){case 0:_context31.prev=0;if($scope.data.openedState.security){_context31.next=19;break;}_context31.prev=2;_context31.next=5;return JSManagement.addJS('ecma5/ExternalLiberary/Desktop/insideController/security.js?dev='+randomVersionName);case 5:$scope.data.removeExternalFuncs['ecma5/ExternalLiberary/Desktop/insideController/security.js?dev='+randomVersionName]='addSecuritySection2DesktopCtrl';_context31.next=8;return addSecuritySection2DesktopCtrl($scope,desktopService,JSManagement,toaster,$uibModal);case 8:$scope.data.openedState.security=true;_context31.next=16;break;case 11:_context31.prev=11;_context31.t0=_context31['catch'](2);console.error(_context31.t0);toaster.pop("error","",_context31.t0||_context31.t0.message);return _context31.abrupt('return');case 16:_context31.prev=16;_.defer(function(){return $scope.$apply();});return _context31.finish(16);case 19:$scope.func.runSecurity();_context31.next=25;break;case 22:_context31.prev=22;_context31.t1=_context31['catch'](0);console.error(_context31.t1);case 25:case'end':return _context31.stop();}}},_callee31,_this,[[0,22],[2,11,16,19]]);}));function securityVisible(){return _ref30.apply(this,arguments);}return securityVisible;}(),relationVisible:function(){var _ref31=_asyncToGenerator(regeneratorRuntime.mark(function _callee32(){return regeneratorRuntime.wrap(function _callee32$(_context32){while(1){switch(_context32.prev=_context32.next){case 0:_context32.prev=0;if($scope.data.openedState.relation){_context32.next=19;break;}_context32.prev=2;_context32.next=5;return JSManagement.addJS('ecma5/ExternalLiberary/Desktop/insideController/relation.js?dev='+randomVersionName);case 5:$scope.data.removeExternalFuncs['ecma5/ExternalLiberary/Desktop/insideController/relation.js?dev='+randomVersionName]='addRelationSection2DesktopCtrl';_context32.next=8;return addRelationSection2DesktopCtrl($scope,desktopService,JSManagement,toaster,$uibModal);case 8:$scope.data.openedState.relation=true;_context32.next=16;break;case 11:_context32.prev=11;_context32.t0=_context32['catch'](2);console.error(_context32.t0);toaster.pop("error","",_context32.t0||_context32.t0.message);return _context32.abrupt('return');case 16:_context32.prev=16;_.defer(function(){return $scope.$apply();});return _context32.finish(16);case 19:$scope.func.runRelation();_context32.next=25;break;case 22:_context32.prev=22;_context32.t1=_context32['catch'](0);console.error(_context32.t1);case 25:case'end':return _context32.stop();}}},_callee32,_this,[[0,22],[2,11,16,19]]);}));function relationVisible(){return _ref31.apply(this,arguments);}return relationVisible;}(),graphVisible:function(){var _ref32=_asyncToGenerator(regeneratorRuntime.mark(function _callee33(){return regeneratorRuntime.wrap(function _callee33$(_context33){while(1){switch(_context33.prev=_context33.next){case 0:_context33.prev=0;if(!($scope.data.selectedFileOrFolder!=null&&$scope.data.selectedFileOrFolder.group!="trash")){_context33.next=15;break;}_context33.next=4;return CSSManagement.addCSS('resource/styleSheet/relation-graph.css?dev='+randomVersionName);case 4:$scope.data.removeExternalCSS['resource/styleSheet/relation-graph.css?dev='+randomVersionName]=true;_context33.next=7;return JSManagement.addJS('resource/javaScript/d3.v3.min.js?dev='+randomVersionName);case 7:$scope.data.removeExternalFuncs['resource/javaScript/d3.v3.min.js?dev='+randomVersionName]='d3';_context33.next=10;return JSManagement.addJS('resource/javaScript/relation-graph.js?dev='+randomVersionName);case 10:$scope.data.removeExternalFuncs['resource/javaScript/relation-graph.js?dev='+randomVersionName]='graph';_context33.next=13;return JSManagement.addJS('ecma5/ExternalLiberary/Public/getNameFromPath.js?dev='+randomVersionName);case 13:$scope.data.removeExternalFuncs['ecma5/ExternalLiberary/Public/getNameFromPath.js?dev='+randomVersionName]='getNameFromPath';_.defer(function(){graph([],'#graphContainer');desktopService.relation.ListRelation($scope.data.selectedFileOrFolder.uuid,2).then(function(res){if(res.data!=null){_.forEach(res.data,function(v){v.source.name=getNameFromPath(v.source.path);v.dest.name=getNameFromPath(v.dest.path);});_.defer(function(){graph(res.data,'#graphContainer');$scope.$apply();});}},function(error){return toaster.pop('error','','عدم دریافت گراف');});},10);case 15:_context33.next=20;break;case 17:_context33.prev=17;_context33.t0=_context33['catch'](0);console.error(_context33.t0);case 20:case'end':return _context33.stop();}}},_callee33,_this,[[0,17]]);}));function graphVisible(){return _ref32.apply(this,arguments);}return graphVisible;}(),historyVisible:function(){var _ref33=_asyncToGenerator(regeneratorRuntime.mark(function _callee34(){return regeneratorRuntime.wrap(function _callee34$(_context34){while(1){switch(_context34.prev=_context34.next){case 0:_context34.prev=0;if($scope.data.openedState.history){_context34.next=19;break;}_context34.prev=2;_context34.next=5;return JSManagement.addJS('ecma5/ExternalLiberary/Desktop/insideController/history.js?dev='+randomVersionName);case 5:$scope.data.removeExternalFuncs['ecma5/ExternalLiberary/Desktop/insideController/history.js?dev='+randomVersionName]='addHistorySection2DesktopCtrl';_context34.next=8;return addHistorySection2DesktopCtrl($scope,desktopService,JSManagement,toaster,$uibModal);case 8:$scope.data.openedState.history=true;_context34.next=16;break;case 11:_context34.prev=11;_context34.t0=_context34['catch'](2);console.error(_context34.t0);toaster.pop("error","",_context34.t0||_context34.t0.message);return _context34.abrupt('return');case 16:_context34.prev=16;_.defer(function(){return $scope.$apply();});return _context34.finish(16);case 19:$scope.func.runHistory();_context34.next=25;break;case 22:_context34.prev=22;_context34.t1=_context34['catch'](0);console.error(_context34.t1);case 25:case'end':return _context34.stop();}}},_callee34,_this,[[0,22],[2,11,16,19]]);}));function historyVisible(){return _ref33.apply(this,arguments);}return historyVisible;}(),personalVisible:function(){var _ref34=_asyncToGenerator(regeneratorRuntime.mark(function _callee35(){return regeneratorRuntime.wrap(function _callee35$(_context35){while(1){switch(_context35.prev=_context35.next){case 0:$scope.func.showLeftItems('personal');_context35.prev=1;_context35.next=4;return $scope.func.clearBeforeInput();case 4:_context35.next=9;break;case 6:_context35.prev=6;_context35.t0=_context35['catch'](1);console.error(_context35.t0);case 9:if($scope.data.trees.personalVisible==null){try{desktopService.repository.getRoot("getUserPersonalFolder").then(function(result){result.data[0].type="FOLDER";result.data[0].group="personal";$scope.data.trees.personalVisible=angular.copy(result.data);$scope.data.pointers["personalVisible"][result.data[0].id]=$scope.data.trees.personalVisible[0];$scope.data.nodesFolder[result.data[0].path]=$scope.data.trees.personalVisible[0];$scope.func.showLeftItems('personal');},function(error){toaster.pop('error','','عدم دریافت موفقیت آمیز ریشه');});}catch(e){console.error(e);}}else if(typeof $scope.data.trees.personalTree.currentNode!=="undefined")$scope.data.trees['personal'].changeCurrentNode($scope.data.pointers["personalVisible"][$scope.data.trees.personalTree.currentNode.uuid],false);case 10:case'end':return _context35.stop();}}},_callee35,_this,[[1,6]]);}));function personalVisible(){return _ref34.apply(this,arguments);}return personalVisible;}(),/*todo RIGHT */metadataVisible:function(){var _ref35=_asyncToGenerator(regeneratorRuntime.mark(function _callee36(){return regeneratorRuntime.wrap(function _callee36$(_context36){while(1){switch(_context36.prev=_context36.next){case 0:$scope.func.showLeftItems('metadata');_context36.prev=1;_context36.next=4;return $scope.func.clearBeforeInput();case 4:_context36.next=9;break;case 6:_context36.prev=6;_context36.t0=_context36['catch'](1);console.error(_context36.t0);case 9:if($scope.data.trees.metadataVisible==null){$scope.data.trees.metadataVisible=[{prop:$translate.instant('search.zm.tree_frequency_metadata'),isLast:false,hasChildrenFolder:true,request:'getTreeAllRoot',rootFolder:[],queryList:[],collapsed:true,children:[],label:$translate.instant('search.zm.tree_frequency_metadata'),id:'root',uuid:'root',type:"FOLDER",group:"metadata"}];$scope.data.pointers["metadataVisible"].root=$scope.data.trees.metadataVisible[0];$scope.func.showLeftItems('metadata');}else if(typeof $scope.data.trees.metadataTree.currentNode!=="undefined")$scope.data.trees['metadata'].changeCurrentNode($scope.data.pointers["metadataVisible"][$scope.data.trees.metadataTree.currentNode.uuid],false);case 10:case'end':return _context36.stop();}}},_callee36,_this,[[1,6]]);}));function metadataVisible(){return _ref35.apply(this,arguments);}return metadataVisible;}(),taxonomyVisible:function(){var _ref36=_asyncToGenerator(regeneratorRuntime.mark(function _callee37(){return regeneratorRuntime.wrap(function _callee37$(_context37){while(1){switch(_context37.prev=_context37.next){case 0:$scope.func.showLeftItems('taxonomy');_context37.prev=1;_context37.next=4;return $scope.func.clearBeforeInput();case 4:_context37.next=9;break;case 6:_context37.prev=6;_context37.t0=_context37['catch'](1);console.error(_context37.t0);case 9:if($scope.data.trees.taxonomyVisible==null){desktopService.repository.getRoot('getRootFolder').then(function(result){result.data[0].type="FOLDER";result.data[0].group="taxonomy";$scope.data.trees.taxonomyVisible=angular.copy(result.data);$scope.data.pointers["taxonomyVisible"][result.data[0].id]=$scope.data.trees.taxonomyVisible[0];$scope.data.nodesFolder[result.data[0].path]=$scope.data.trees.taxonomyVisible[0];$scope.func.showLeftItems('taxonomy');},function(error){toaster.pop('error','','عدم دریافت موفقیت آمیز ریشه');});}else if(typeof $scope.data.trees.taxonomyTree.currentNode!=="undefined"){$scope.data.trees['taxonomy'].changeCurrentNode($scope.data.pointers["taxonomyVisible"][$scope.data.trees.taxonomyTree.currentNode.uuid],false);}case 10:case'end':return _context37.stop();}}},_callee37,_this,[[1,6]]);}));function taxonomyVisible(){return _ref36.apply(this,arguments);}return taxonomyVisible;}(),categoriesVisible:function(){var _ref37=_asyncToGenerator(regeneratorRuntime.mark(function _callee38(){return regeneratorRuntime.wrap(function _callee38$(_context38){while(1){switch(_context38.prev=_context38.next){case 0:$scope.func.showLeftItems('category');_context38.prev=1;_context38.next=4;return $scope.func.clearBeforeInput();case 4:_context38.next=9;break;case 6:_context38.prev=6;_context38.t0=_context38['catch'](1);console.error(_context38.t0);case 9:if($scope.data.trees.categoryVisible==null){desktopService.repository.getRoot('getCategoriesFolder').then(function(result){result.data[0].type="FOLDER";result.data[0].group="category";$scope.data.trees.categoryVisible=angular.copy(result.data);$scope.data.pointers["categoryVisible"][result.data[0].id]=$scope.data.trees.categoryVisible[0];$scope.data.nodesFolder[result.data[0].path]=$scope.data.trees.categoryVisible[0];$scope.func.showLeftItems('category');},function(error){toaster.pop('error','','عدم دریافت موفقیت آمیز ریشه');});}else if(typeof $scope.data.trees.categoryTree.currentNode!=="undefined")$scope.data.trees['category'].changeCurrentNode($scope.data.pointers["categoryVisible"][$scope.data.trees.categoryTree.currentNode.uuid],false);case 10:case'end':return _context38.stop();}}},_callee38,_this,[[1,6]]);}));function categoriesVisible(){return _ref37.apply(this,arguments);}return categoriesVisible;}(),trashVisible:function(){var _ref38=_asyncToGenerator(regeneratorRuntime.mark(function _callee39(){return regeneratorRuntime.wrap(function _callee39$(_context39){while(1){switch(_context39.prev=_context39.next){case 0:$scope.func.showLeftItems('trash');_context39.prev=1;_context39.next=4;return $scope.func.clearBeforeInput();case 4:_context39.next=9;break;case 6:_context39.prev=6;_context39.t0=_context39['catch'](1);console.error(_context39.t0);case 9:if($scope.data.trees.trashVisible==null){desktopService.repository.getRoot('getUserTrashFolder').then(function(result){result.data[0].type="FOLDER";result.data[0].group='trash';$scope.data.trees.trashVisible=angular.copy(result.data);$scope.data.pointers["trashVisible"][result.data[0].id]=$scope.data.trees.trashVisible[0];$scope.data.nodesFolder[result.data[0].path]=$scope.data.trees.trashVisible[0];$scope.func.showLeftItems('trash');},function(error){return toaster.pop('error','','عدم دریافت موفقیت آمیز ریشه');});}else if(typeof $scope.data.trees.trashTree.currentNode!=="undefined")$scope.data.trees['trash'].changeCurrentNode($scope.data.pointers["trashVisible"][$scope.data.trees.trashTree.currentNode.uuid],false);case 10:case'end':return _context39.stop();}}},_callee39,_this,[[1,6]]);}));function trashVisible(){return _ref38.apply(this,arguments);}return trashVisible;}(),templatesVisible:function(){var _ref39=_asyncToGenerator(regeneratorRuntime.mark(function _callee40(){return regeneratorRuntime.wrap(function _callee40$(_context40){while(1){switch(_context40.prev=_context40.next){case 0:$scope.func.showLeftItems('templates');_context40.prev=1;_context40.next=4;return $scope.func.clearBeforeInput();case 4:_context40.next=9;break;case 6:_context40.prev=6;_context40.t0=_context40['catch'](1);console.error(_context40.t0);case 9:if($scope.data.trees.templatesVisible==null){desktopService.repository.getRoot('getTemplatesFolder').then(function(result){result.data[0].type="FOLDER";result.data[0].group="templates";$scope.data.trees.templatesVisible=angular.copy(result.data);$scope.data.pointers["templatesVisible"][result.data[0].id]=$scope.data.trees.templatesVisible[0];$scope.data.nodesFolder[result.data[0].path]=$scope.data.trees.templatesVisible[0];$scope.func.showLeftItems('templates');},function(error){toaster.pop('error','','عدم دریافت موفقیت آمیز ریشه');});}else if(typeof $scope.data.trees.templatesTree.currentNode!=="undefined")$scope.data.trees['templates'].changeCurrentNode($scope.data.pointers["templatesVisible"][$scope.data.trees.templatesTree.currentNode.uuid],false);case 10:case'end':return _context40.stop();}}},_callee40,_this,[[1,6]]);}));function templatesVisible(){return _ref39.apply(this,arguments);}return templatesVisible;}(),propertyVisible:function propertyVisible(){//TODO get all properties Item
try{if($scope.data.selectedFileOrFolder!=null&&$scope.data.selectedFileOrFolder.group!="trash"){desktopService[$scope.data.lookupTableType[$scope.data.selectedFileOrFolder.type]].getProperties($scope.data.selectedFileOrFolder.uuid).then(function(){var _ref40=_asyncToGenerator(regeneratorRuntime.mark(function _callee41(res){var result,create,lastModify;return regeneratorRuntime.wrap(function _callee41$(_context41){while(1){switch(_context41.prev=_context41.next){case 0:_context41.next=2;return JSManagement.addJS('ecma5/ExternalLiberary/Search/miladiToJalaliFunction.js?dev='+randomVersionName);case 2:$scope.data.removeExternalFuncs['ecma5/ExternalLiberary/Search/miladiToJalaliFunction.js?dev='+randomVersionName]='miladiToJalaliFunction';result=_.clone(res.data.originalElement[$scope.data.lookupTableType[$scope.data.selectedFileOrFolder.type]]);_context41.next=6;return miladiToJalaliFunction(result.created);case 6:create=_context41.sent;_context41.next=9;return miladiToJalaliFunction(result.lastModified);case 9:lastModify=_context41.sent;$scope.data.Properties={author:result.author,created:result.created,jalaliCreateDate:_.clone(create),jalaliLastModified:_.clone(lastModify),path:result.path,permissions:result.permissions,subscribed:_.has(result,'subscribed')?result.subscribed:false,uuid:result.uuid,keywords:result.keywords,name:result.name,mimeType:result.mimeType,status:_.has(result,'lockInfo')?' '+result.lockInfo.owner+' قفل شده توسط  ':'در دسترس'};try{$scope.data.Properties.size=result.actualVersion.size;}catch(e){$scope.data.Properties.size=-1;}console.info("SIZE");console.info($scope.data.Properties.size);if(result.categories){result.categories=_.isArray(result.categories)?result.categories:[result.categories];_.forEach(result.categories,function(cat){return cat.name=typeof cat.path==="string"?_.last(_.filter(_.split(cat.path,"/"),function(s){return s.trim()!="";})):"";});$scope.data.Properties.Categories=_.clone(result.categories);}else $scope.data.Properties.Categories=null;create=undefined;lastModify=undefined;result=undefined;_.defer(function(){return $scope.$apply();});case 19:case'end':return _context41.stop();}}},_callee41,_this);}));return function(_x40){return _ref40.apply(this,arguments);};}(),function(error){return toaster.pop('error','','عدم دریافت اطلاعات');});}}catch(e){console.error(e);}}};/** TODO ------------------------- categoryVisible  functions ----------------------------------- **/$scope.func.deleteCategory=function(category){try{desktopService.property.deleteCategory($scope.data.Properties.uuid,category.uuid).then(function(res){_.remove($scope.data.Properties.Categories,function(cat){return cat.uuid==category.uuid;});if($scope.data.Properties.Categories.length==0)$scope.data.Properties.Categories=null;_.defer(function(){return $scope.$apply();});},function(error){return toaster.pop('error','','امکان حذف این آیتم نیست');});}catch(e){console.error(e);}};/** TODO ------------------------- jquery animation functions ----------------------------------- **/$scope.func.animate=function(id){$(id).animate({color:'red',opacity:'0.2'}).animate({color:'black',opacity:'1'},"fast",function(){});};/** TODO ------------------------- background functions ----------------------------------------- **/$scope.$on('changeFeature',function(){var _ref41=_asyncToGenerator(regeneratorRuntime.mark(function _callee42(event,args){return regeneratorRuntime.wrap(function _callee42$(_context42){while(1){switch(_context42.prev=_context42.next){case 0:if(!(typeof args.changeInfo!=="undefined"&&args.changeInfo==true)){_context42.next=7;break;}_context42.next=3;return FeaturesManagement.getFeatures(desktopService.auth);case 3:$scope.data.profile=_context42.sent;$scope.data.isShowDesktop=true;$scope.func.sidesShowOrHidden();$scope.func.checkReciveData();case 7:case'end':return _context42.stop();}}},_callee42,_this);}));return function(_x41,_x42){return _ref41.apply(this,arguments);};}());$scope.$on('$stateChangeSuccess',function(){// do something
$scope.func.run();});$scope.func.checkReciveData=_asyncToGenerator(regeneratorRuntime.mark(function _callee43(){var item;return regeneratorRuntime.wrap(function _callee43$(_context43){while(1){switch(_context43.prev=_context43.next){case 0:_context43.prev=0;if(!(_.has($state,'params')&&_.has($state.params,'uid')&&$state.params.uid!=="")){_context43.next=4;break;}$scope.func.createNewMetaData(_.filter($state.params.uid.split(/(?:\/([^_]+)_type=([\w]+))/gi),function(i){return i!="";}));return _context43.abrupt('return');case 4:_context43.prev=4;_context43.next=7;return getSelectedLocalStorage('selectedMetadataState');case 7:$scope.data.clipboardFolder=_context43.sent;_context43.next=13;break;case 10:_context43.prev=10;_context43.t0=_context43['catch'](4);console.error(_context43.t0);case 13:_context43.next=15;return JSManagement.addJS('ecma5/ExternalLiberary/Public/saveChangeStateVar.js?dev='+randomVersionName);case 15:_context43.next=17;return getStateVarFunction();case 17:item=_context43.sent;if(!(item!=undefined)){_context43.next=24;break;}$scope.data.nav.right.selectedSide='taxonomyVisible';$scope.data.nav.right.isOpened=true;if(_.has(item,'isMetaData'))$scope.func.generateAbstractPath(_.clone(item.value.path),_.clone(item.value),true);else $scope.func.generateAbstractPath(_.clone(item.path),_.clone(item),true);_context43.next=24;return setStateVarFunction(undefined);case 24:_context43.next=29;break;case 26:_context43.prev=26;_context43.t1=_context43['catch'](0);console.error(_context43.t1);case 29:case'end':return _context43.stop();}}},_callee43,_this,[[0,26],[4,10]]);}));$scope.func.run=_asyncToGenerator(regeneratorRuntime.mark(function _callee44(){return regeneratorRuntime.wrap(function _callee44$(_context44){while(1){switch(_context44.prev=_context44.next){case 0:_context44.prev=0;_context44.next=3;return FeaturesManagement.getFeatures(desktopService.auth);case 3:$scope.data.profile=_context44.sent;$scope.func.sidesShowOrHidden();$scope.data.isShowDesktop=true;$scope.func.checkReciveData();_context44.next=12;break;case 9:_context44.prev=9;_context44.t0=_context44['catch'](0);console.error(_context44.t0);case 12:case'end':return _context44.stop();}}},_callee44,_this,[[0,9]]);}));$scope.$on("$destroy",function(){try{// clear all interval and timeouts
window.clearAllIntervals();_.forEach(_.clone($scope.data.removeExternalCSS),function(){var _ref44=_asyncToGenerator(regeneratorRuntime.mark(function _callee45(value,src){return regeneratorRuntime.wrap(function _callee45$(_context45){while(1){switch(_context45.prev=_context45.next){case 0:_context45.prev=0;_context45.next=3;return CSSManagement.removeCSS(src);case 3:_context45.next=8;break;case 5:_context45.prev=5;_context45.t0=_context45['catch'](0);console.error(_context45.t0);case 8:case'end':return _context45.stop();}}},_callee45,_this,[[0,5]]);}));return function(_x43,_x44){return _ref44.apply(this,arguments);};}());_.forEach(_.clone($scope.data.removeExternalFuncs),function(){var _ref45=_asyncToGenerator(regeneratorRuntime.mark(function _callee46(funcName,src){return regeneratorRuntime.wrap(function _callee46$(_context46){while(1){switch(_context46.prev=_context46.next){case 0:_context46.prev=0;_context46.next=3;return JSManagement.removeJS(src,funcName);case 3:_context46.next=8;break;case 5:_context46.prev=5;_context46.t0=_context46['catch'](0);console.error(_context46.t0);case 8:case'end':return _context46.stop();}}},_callee46,_this,[[0,5]]);}));return function(_x45,_x46){return _ref45.apply(this,arguments);};}());try{//$( "#clipBoardMetaDataSaved" ).draggable().remove();
$("#clipBoardMetaDataSaved").draggable("destroy");}catch(e){console.error(e);}try{$scope.func.stopAllPlayers();}catch(e){console.error(e);}// clear all data and functions
$scope.externalScopeParent=undefined;$scope.externalScope=undefined;$scope.func={};$scope.func=undefined;$scope.data={};$scope.data=undefined;}catch(e){console.error(e);}});resolve(true);}catch(e){reject("مشکلی در ورود به دسکتاپ به وجود آمده است لطفا مجددا تلاش کنید .");}});};